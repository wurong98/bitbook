
# 共识规则

| 类别      | 例子                            | 是否可改   |
| ------- | ----------------------------- | ------ |
| 核心共识规则  | 总量、PoW、UTXO、签名算法、区块链结构        | ❌ 绝不能动 |
| 外围协议/功能 | SegWit、Taproot、闪电网络、RBF、P2P优化 | ✅ 可以改  |

## 引言

比特币的生命力源于其精心设计的共识机制。然而，一个常见的误解是：比特币是固定不变的。实际上，比特币协议存在两个不同的层次——**核心的、不可改动的共识规则**和**可优化升级的外围协议**。理解这两者的区别，对于我们正确认识比特币的未来演进至关重要。

## 第一节 核心共识规则：比特币的宪法

这些是比特币网络存在的基础。它们就像一部"宪法"，定义了什么是有效的比特币、什么是无效的。一旦改动，就会破坏全网共识，导致永久性网络分裂。

### 一、总量固定与发行机制

比特币最核心的承诺之一就是**货币供应量有限**。具体规则如下：

- **总量上限**：永不超过 2,100 万 BTC
- **减半周期**：每 210,000 个区块（约 4 年）矿工奖励减半
- **矿工奖励规则**：从初始 50 BTC 开始，按照减半规则逐次递减

**为何这条规则不能改动？** 如果我们修改总量或减半规则，比特币的核心价值主张——"稀缺性"就会崩塌。这不仅会导致通胀，更重要的是，全球数百万节点和钱包无法达成一致，最终导致网络分叉。这就不再是同一条比特币链了。

### 二、区块链结构

每个区块都严格遵循特定的数据结构：

- 每个区块包含**前一区块的哈希值**，形成不可破的链式结构
- 区块头包含特定的字段（版本、时间戳、难度目标等）
- 所有交易通过 **Merkle 树** 聚合成一个 Merkle 根

**为何这条规则不能改动？** 这套结构是区块链安全性和不可篡改性的基石。一旦改变，历史区块的有效性就会失效，过去的所有交易都需要重新验证。这相当于要求全网重新确认整个历史，是不可行的。

### 三、工作量证明（PoW）

PoW 是比特币的安全保障：

- **哈希难度动态调整**：每 2,016 个区块调整一次，保持 10 分钟的平均出块时间
- **工作量验证规则**：节点必须验证区块头哈希是否低于目标难度

**为何这条规则不能改动？** PoW 是比特币去中心化和防篡改的唯一保障。改变难度调整算法或验证规则，就等于削弱了网络的安全性。攻击者可能会利用这一变化发动 51% 攻击，重写历史。

### 四、UTXO 模型

UTXO（未花费交易输出集）是比特币账本系统的核心：

- 每笔交易的**输入和输出不可被篡改**
- 所有未花费的输出集合构成了整个比特币的"账本状态"

**为何这条规则不能改动？** UTXO 是比特币唯一且权威的状态表示。如果我们改变 UTXO 模型（例如改为账户模型），全网数百万个节点的账本状态就会不一致，再也无法达成共识。

### 五、交易验证规则

交易有效性的判断标准：

- **数字签名必须有效**：证明交易所有者确实授权了这笔支出
- **输入总额 ≥ 输出总额**：防止凭空创造比特币
- **序列号和锁定时间规则**：控制交易的有效性和执行时间

**为何这条规则不能改动？** 这是防止双花和欺诈交易的基础防线。一旦放松这些规则，比特币网络就变成了可以被任意冒充和欺骗的系统。

### 六、加密算法

比特币依赖的加密基础设施：

- **签名算法**：ECDSA（椭圆曲线数字签名算法）配合 secp256k1 曲线
- **哈希函数**：SHA-256 + RIPEMD-160

**为何这条规则不能改动？** 改变签名或哈希算法意味着所有既有的钱包、地址和私钥都需要迁移。这不仅在技术上极其复杂，而且会导致大规模的不兼容性。此外，还需要确保新算法的密码学安全性经过充分验证。

### 小结：比特币的"DNA"

> 一个核心事实是：**破坏这些规则，就不再是比特币了。全网节点会产生永久分叉，最终形成两条不同的区块链。**

这也是为什么我们看到过比特币现金（Bitcoin Cash）、比特币黄金（Bitcoin Gold）等分叉币。它们正是因为改动了某些核心共识规则，从而与原始比特币分离。

---

## **二、可以改进优化的协议层（外围可升级功能）**

这些改进不破坏核心共识，通常通过软分叉或层2方案实现：

1. **交易结构优化**

   * **SegWit**：分离签名数据，提升区块容量
   * **Schnorr/Taproot**：聚合签名、智能合约简化
   * **RBF（Replace-by-Fee）**：可替换未确认交易

2. **扩展区块容量/吞吐**

   * 闪电网络（Lightning Network）——Layer2，处理小额支付
   * 区块内交易压缩（如未来可能的交易数据优化）

3. **隐私与匿名**

   * CoinJoin、Taproot 脚本隐私
   * 可选，不破坏核心 UTXO 模型

4. **网络层优化**

   * P2P 消息传播优化
   * 节点连接和同步速度优化
   * 区块传播压缩

5. **钱包与客户端优化**

   * SPV（简化支付验证）
   * 钱包安全改进、签名方案升级
   * 用户体验改善（不涉及链的核心规则）

